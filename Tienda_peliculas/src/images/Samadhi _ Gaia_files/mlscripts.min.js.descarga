function parseEmailResponseMessage(e,n,o){var i=$(n).find(".message"),s=e.toLowerCase();"sending"===s?i.text("").removeClass("error success sending").addClass("loading").fadeIn():$.getJSON("/wp-content/themes/gaia-marketing-layer/assets/json/form-messaging.json",function(e){var t=e[GAIA_GLOBALS.lang][s],e=i.attr("data-success-override"),a="success"===s?"success":"error";"success"===s&&""!==e&&"Thanks!"!==e&&(t=e),i.removeClass("error success sending"),"success"!=a||o?o&&"error"!=a||(i.removeClass("loading").addClass("error").text(t).fadeIn(750),$(n).find(".submit-btn").removeClass("btn--disabled").prop("disabled",!1)):$(n).fadeOut("slow",function(){$(this).find("form").hide().end().fadeIn(750),i.removeClass("loading").addClass(a).text(t).show()})}).fail(function(){console.log("Error loading language preference text config file for Email response.")})}$.fn.emarsysWebExtend=function(e){ScarabQueue&&ScarabQueue.push(["setEmail",e])},$.fn.checkoutCartBegin=function(n,e){var t=$(n).find("input[name=EMAIL_ADDRESS_]").val(),a=GAIA_GLOBALS.site_segment,o=$(n).find("input[name=FORM_NAME]").val(),i=e||"/plan-selection"+("en"!==GAIA_GLOBALS.lang?"?language[]="+GAIA_GLOBALS.lang:""),i=$.fn.appendContentIds($.fn.preserveQueryString(i)),s={email:t,country:GAIA_GLOBALS.locale.toUpperCase(),sku:"NO_SKU_SELECTED",language:[GAIA_GLOBALS.lang],fields:{form_name:o,url:encodeURI(window.location.pathname)}};parseEmailResponseMessage("sending",n,i),s.fields["prospect_email_comm_"+a]=!0,s.fields.prospect_behavior_segment=a,GAIA_GLOBALS.content_id&&(s.fields.prospect_content_id=GAIA_GLOBALS.content_id),GAIA_GLOBALS.content_category&&(s.fields.prospect_content_category=GAIA_GLOBALS.content_category),GAIA_GLOBALS.content_subcategory&&(s.fields.prospect_content_subcategory=GAIA_GLOBALS.content_subcategory),""!==String(window.location.search)&&(s.fields.utm=encodeURI(String(window.location.search).replace("?",""))),$(n).find(".submit-btn").addClass("btn--disabled").prop("disabled",!0),void 0!==$(n).find("input[name=FIRST_NAME]").val()&&(s.fields.first_name=$(n).find("input[name=FIRST_NAME]").val()),void 0!==$(n).find("input[name=LAST_NAME]").val()&&(s.fields.last_name=$(n).find("input[name=LAST_NAME]").val()),void 0!==$(n).find("input[name=PHONE_NUMBER]").val()&&(s.fields.phone_number=$(n).find("input[name=PHONE_NUMBER]").val());var r=GAIA_GLOBALS.dbi_brooklyn_api+"/v1/checkout/cart-begin";function l(){parseEmailResponseMessage("success",n,i),$.fn.setEmailSessionStorage(t),window.location=i}$.fn.checkEmailAvailability(s,function(){var e=new Promise((e,t)=>{setTimeout(()=>{e("backend")},29e3,"backend")}),t=new Promise((e,t)=>{setTimeout(()=>{e("frontend")},3e3,"frontend")});try{Promise.race([e,t]).then(e=>{l()})}catch(e){console.log("CartBeging Error: Tried promise -> ",e)}$.ajax({method:"POST",url:r,data:JSON.stringify(s),contentType:"application/json",processData:!1,dataType:"json",success:function(e,t,a){e&&!0===e.success?l():e&&!1===e.success&&e.errorCode?parseEmailResponseMessage(e.errorCode,n,i):(console.log("Cart Begin Response Status: Unknown -> ",e),parseEmailResponseMessage("default",n,i))},error:function(e,t,a){console.log("Unknown Error (usually 400): jqXHR: ",e," Cart Begin  Error: ",t," errorThrown: ",a),e.responseText&&('child "email" fails because ["email" must be a valid email]'==(e=JSON.parse(e.responseText)).message||'"email" must be a valid email'==e.errors[0].meta[0])?($(n).find(".submit-btn").removeClass("btn--disabled").prop("disabled",!1),parseEmailResponseMessage("email_invalid",n,i)):parseEmailResponseMessage("default",n,i)}})},parseEmailResponseMessage,n,i)},$.fn.emarsysEmailCap=function(o,e,t){var n=$(o).find("input[name=EMAIL_ADDRESS_]").val(),a=GAIA_GLOBALS.site_segment,i=$(o).find("input[name=FORM_NAME]").val(),s=t?$.fn.appendContentIds($.fn.preserveQueryString(t)):null,i={email:n,source:"",optin:!0,fields:{form_name:i,url:encodeURI(window.location.pathname),registration_language:GAIA_GLOBALS.lang},utm:""!==String(window.location.search)?encodeURI(String(window.location.search).replace("?","")):""};parseEmailResponseMessage("sending",o,s),e||(i.fields["prospect_email_comm_"+a]=!0,i.fields.prospect_behavior_segment=a,GAIA_GLOBALS.content_id&&(i.fields.prospect_content_id=GAIA_GLOBALS.content_id),GAIA_GLOBALS.content_category&&(i.fields.prospect_content_category=GAIA_GLOBALS.content_category),GAIA_GLOBALS.content_subcategory&&(i.fields.prospect_content_subcategory=GAIA_GLOBALS.content_subcategory)),$(o).find(".submit-btn").addClass("btn--disabled").prop("disabled",!0),void 0!==$(o).find("input[name=FIRST_NAME]").val()&&(i.fields.first_name=$(o).find("input[name=FIRST_NAME]").val()),void 0!==$(o).find("input[name=LAST_NAME]").val()&&(i.fields.last_name=$(o).find("input[name=LAST_NAME]").val()),void 0!==$(o).find("input[name=PHONE_NUMBER]").val()&&(i.fields.phone_number=$(o).find("input[name=PHONE_NUMBER]").val());a=GAIA_GLOBALS.dbi_brooklyn_api+"/email-capture";$.ajax({method:"POST",url:a,data:JSON.stringify(i),contentType:"application/json",processData:!1,dataType:"json",success:function(e,t,a){e&&!0===e.success?(parseEmailResponseMessage("success",o,s),$.fn.emarsysWebExtend(n),(GAIA_GLOBALS.greer_ab_v1||GAIA_GLOBALS.email_sign_up_address)&&$.fn.setEmailSessionStorage(n),dataLayer.push({event:"customEvent",eventCategory:"email collection",eventAction:"email submitted",eventLabel:"in-page"}),s&&(window.location=s),$(".gate-keeper").trigger("layerGate:submitEmailSuccess")):e&&!1===e.success&&e.errorCode?parseEmailResponseMessage(e.errorCode,o,s):(console.log("Emarsys Response Status: Unknown -> ",e),parseEmailResponseMessage("default",o,s))},error:function(e,t,a){var n;console.log("Unknown Error (usually 400): jqXHR: ",e," emarsysEmailCap Error: ",t," errorThrown: ",a),e.responseText&&(n=JSON.parse(e.responseText)).message&&'child "email" fails because ["email" must be a valid email]'==n.message?($(o).find(".submit-btn").removeClass("btn--disabled").prop("disabled",!1),parseEmailResponseMessage("email_invalid",o,s)):parseEmailResponseMessage("default",o,s)}})},$.fn.checkEmailAvailability=function(e,t,a,n,o){var i=GAIA_GLOBALS.dbi_brooklyn_api+"/v1/checkout/account-check";$.ajax({method:"POST",url:i,data:JSON.stringify(e),contentType:"application/json",dataType:"json",success:function(e){e&&!0===e.available&&t(),e&&!1===e.available&&a("email_available_error",n,o)},error:function(e){console.log("ERROR: Check Email Availability-> ",e),a("default",n,o)}})},$.fn.getMemberEmail=function(){var e=Cookies.getJSON("auth");return e&&e.email?e.email:"unknown"},$.fn.initCountDown=function(t,e){function a(e){return 9<e?e.toString():"0"+e}var n;void 0===GAIA_GLOBALS.timers["timer_"+t]?(n=t.getTime()-e.getTime(),GAIA_GLOBALS.timers["timer_"+t]=setInterval(function(){var e;0<n?(e={days:a(Math.floor(n/864e5)),hours:a(Math.floor(n%864e5/36e5)),minutes:a(Math.floor(n%36e5/6e4)),seconds:a(Math.floor(n%6e4/1e3))},$(".countdown-timer-listener").trigger("countDownTimer:update",e)):(clearInterval(GAIA_GLOBALS.timers["timer_"+t]),$(".countdown-timer-listener").trigger("countDownTimer:complete")),n-=1e3},1e3)):console.log("Timer Already Exists keyed: ",t)},$.fn.getHumanReadableSiteSegment=function(e){switch((e=void 0===e?GAIA_GLOBALS.site_segment:e).toUpperCase()){case"ST":$ss="Seeking Truth";break;case"TR":$ss="Transformation";break;case"MY":$ss="Yoga";break;case"AH":$ss="Alternative Healing";break;default:$ss="Brand"}return $ss},$.fn.smoothScroll=function(e,t,a){if(e.length){var n=void 0!==a&&a.duration?a.duration:1e3,a=void 0!==a&&a.offset?a.offset:0;return $("html, body").animate({scrollTop:e.offset().top-a},n,function(){t&&t()}),!1}},$.fn.isOnScreen=function(){var e=$(window),t={top:e.scrollTop(),left:e.scrollLeft()},a=this.offset();if(void 0!==a)return t.right=t.left+e.width(),t.bottom=t.top+e.height(),a.right=a.left+this.outerWidth(),a.bottom=a.top+this.outerHeight(),!(t.right<a.left||t.left>a.right||t.bottom<a.top||t.top>a.bottom);console.log("!WARNING: The target is undefined when isOnScreen method was called...")},$.fn.hexToRGBA=function(e,t){return void 0!==e&&-1!=e.indexOf("#")?(e=e.replace(new RegExp("[^0-9A-F]","gi"),""),r=parseInt(e.substring(0,2),16),g=parseInt(e.substring(2,4),16),b=parseInt(e.substring(4,6),16),a=isNaN(t)?1:t/100,"rgba("+r+","+g+","+b+","+a+")"):"rgba(255,255,255,0)"},$.fn.getReadableDuration=function(e,t){var a=new Date(1e3*e),n=a.getUTCHours(),o=a.getUTCMinutes(),i=a.getSeconds(),s="",r=t&&t.hours?t.hours:" hrs ",e=t&&t.hour?t.hour:" hr ",a=t&&t.mins?t.mins:" mins";return i<10&&0,1<n?s+=n+r:0<n&&(s+=n+e),s+=(t&&t.delimiter&&0<n?t.delimiter:" ")+o+a},$.fn.getAPIData=function(e,n,t,a){$.ajax({method:void 0!==t?t:"GET",url:e,data:void 0!==a?a:{},dataType:"json",success:function(e,t,a){e?n(e):n()},error:function(e,t,a){console.log("API Data Error: ",t," errorThrown: ",a," jqXHR: ",e),n(null)}})},$.fn.isLoggedIn=function(){var e=Cookies.getJSON("auth");return!(!e||!e.jwt)},$.fn.getSubType=function(){var e=Cookies.getJSON("auth");if(e&&e.subscriptions){if(-1!==$.inArray(290,e.subscriptions))return"allaccess";if(-1!==$.inArray(280,e.subscriptions))return"annual";if(-1!==$.inArray(253,e.subscriptions))return"monthly"}return"unknown"},$.fn.getQueryString=function(e){var t,a=[];if(null!=(n=document.URL.split("?")[1]))for(var n=n.split("&"),o=0;o<n.length;o++)t=n[o].split("="),a.push(t[1]),a[t[0]]=t[1];return void 0!==e?a[e]:a},$.fn.preserveQueryString=function(e){function t(e){if((t=e.split("?"))[1]&&0<t[1].length){for(var t=(t=-1<(t=t[1]).indexOf("#")?t.split("#")[0]:t).split("&"),a=[],n=0;n<t.length;n++){var o=t[n].split("=");a[o[0]]=o[1]}return a}}var a=t($(location).attr("href")),n=t(e),o=$.extend(a,n);if($.isEmptyObject(o))return e;e=e.split("?")[0];var i,s=0;for(i in o)o.hasOwnProperty(i)&&(e+=(s<1?"?":"&")+i+"="+o[i]),s++;return e},$.fn.linkCheck=function(e){var t,a,n=$(e).attr("href");n&&0!==n.indexOf("#")&&(t=n,$(location).attr("href"),a=n.split("#")[1],-1<n.indexOf("#")&&(t=n.split("#")[0]),t=$.fn.preserveQueryString(t),t=$.fn.appendContentIds(t),a&&0<a.length&&(t=t+"#"+a),"_self"==$(e).attr("target")?window.open(t,"_self"):window.open(t,"_blank"))},$.fn.appendContentIds=function(e){var t;return $("body").data("ci_type")&&$("body").data("ci_nid")&&(t="ci_type="+$("body").data("ci_type")+"&ci_id="+$("body").data("ci_nid"),e=(e=-1<e.indexOf("ci_type")||-1<e.indexOf("ci_nid")?e.replace(/(\??)ci_type=(.*)&ci_id=(\d*)(&|$)/gim,""):e)+(-1<e.indexOf("?")?"&":"?")+t),e},$.fn.setEmailSessionStorage=function(e){var t={};(t=sessionStorage.gaia?JSON.parse(sessionStorage.gaia):t)[-1]||(t[-1]={}),t[-1].emailSignupAddress||(t[-1].emailSignupAddress={}),t[-1].emailSignupAddress=e,sessionStorage.setItem("gaia",JSON.stringify(t))},$.fn.setLanguagePreference=function(e,t){var a=JSON.parse(localStorage.getItem("gaia")),n=void 0!==t?t:"",t="-1";a&&a[t]&&void 0!==a[t].user&&void 0!==a[t].user.data&&a[t].user.data.languageAlertBarAccepted&&(n=!0),(a=a||{})[t]||(a[t]={}),a[t].user||(a[t].user={}),a[t].user.data||(a[t].user.data={}),a[t].user.data.language||(a[t].user.data.language={}),a[t].user.data.languageAlertBarAccepted||(a[t].user.data.languageAlertBarAccepted={}),a[t].user.data.language=[e],a[t].user.data.languageAlertBarAccepted=n,sessionStorage.setItem("gaia",JSON.stringify(a)),$.fn.getCookieAllowance()&&localStorage.setItem("gaia",JSON.stringify(a))},$.fn.getLoggedInLanguagePref=function(t,n){$.ajax({method:"GET",url:GAIA_GLOBALS.dbi_brooklyn_api+"/v2/feature-tracking",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t)},success:function(e,t,a){e&&e.userLanguages[0]?n(e.userLanguages[0]):(console.log("WARNING: No data was language data returned for getLoggedInLanguagePref query."),n("unknown"))},error:function(e,t,a){console.log("getLoggedInLanguagePref Error: ",t," errorThrown: ",a),n("unknown")}})},$.fn.getCookieAllowance=function(){if(localStorage.getItem("gaia")){var e=JSON.parse(localStorage.getItem("gaia")),a=null;return $.each(e,function(e,t){e=parseInt(e),(!t||-1===e&&null===a||-1<e)&&(a=e)}),-1===a?!(!e||!e[a]||void 0===e[a].cookieOptInAccepted||!0!==e[a].cookieOptInAccepted):0<a||void 0}return!1},$.fn.openModal=function(e,t){var a=$(".layer-modal");a.find(".modal-inner").hide().end(),void 0!==t&&!1===t?$(".layer-modal .close-modal-btn").hide():$(".layer-modal .close-modal-btn").show(),a.find(e).show().end(),a.fadeIn(250)},$.fn.closeModal=function(){$(".layer-modal").fadeOut(250)},function(i){var s={list:null,auth:null},r={init:function(e){e&&i.extend(s,e),s.auth=Cookies.getJSON("auth"),s.list=r.get()},get:function(e){s.auth&&s.auth.jwt&&i.ajax({method:"GET",url:GAIA_GLOBALS.dbi_brooklyn_api+"/v2/playlists",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+s.auth.jwt)},success:function(e,t,a){e?(s.list=[],i.each(e.videos,function(e,t){s.list.push(t.nid)}),i(".playlist-btn").trigger("playlist:updatePlaylist")):console.log("WARNING: No data was returned for get playlist.")},error:function(e,t,a){console.log("Error: ",t," errorThrown: ",a)}})},exists:function(e,t){var a=!1;t(a=-1<i.inArray(parseInt(e),s.list)?!0:a)},add:function(n,o){i.ajax({method:"POST",url:GAIA_GLOBALS.dbi_brooklyn_api+"/v3/playlists/default/add/"+n,dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+s.auth.jwt)},success:function(e,t,a){e?(i(".playlist-btn").trigger("playlist:addedItem",n),r.get(n),dataLayer&&dataLayer.push({event:"addPlaylist",eventCategory:"playlist",eventAction:"added to playlist",eventLabel:n+"|"+o})):console.log("WARNING: No data was returned for add to playlist item.")},error:function(e,t,a){console.log("Error: ",t," errorThrown: ",a)}})},remove:function(n,e){i.ajax({method:"POST",url:GAIA_GLOBALS.dbi_brooklyn_api+"/v3/playlists/default/remove/"+n,dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+s.auth.jwt)},success:function(e,t,a){e?(i(".playlist-btn").trigger("playlist:removedItem",n),r.get(n),dataLayer):console.log("WARNING: No data was returned for remove playlist item.")},error:function(e,t,a){console.log("Error: ",t," errorThrown: ",a)}})}};i.fn.playlistUtils=function(e){var t=arguments,a=this;return this.each(function(){return r[e]?r[e].apply(a,Array.prototype.slice.call(t,1)):"object"!=typeof e&&e?void i.error("Method "+e+" does not exist on jQuery.plugin"):r.init.apply(a,Array.prototype.slice.call(t,0))})}}(jQuery),$(document).ready(function(){var e,t;$.fn.isLoggedIn()&&((e=window.location.pathname)==="/"+GAIA_GLOBALS.lang?window.location="/"+window.location.search:e.includes("/"+GAIA_GLOBALS.lang+"/series/")&&"localhost"!==window.location.hostname&&(t=window.location.pathname.split("series/")[1],window.location="/series/"+t+"?language[]="+GAIA_GLOBALS.lang),$(document).playlistUtils().init(),(t=Cookies.getJSON("auth"))&&t.email&&$.fn.emarsysWebExtend(t.email)),!$.fn.isLoggedIn()||$.fn.isLoggedIn()&&GAIA_GLOBALS.gated&&GAIA_GLOBALS.gated.override_logged_in&&1===GAIA_GLOBALS.gated.override_logged_in?($(".layer.layer-hide-logged-out").hide(),GAIA_GLOBALS.gated&&(t=$.fn.hexToRGBA(GAIA_GLOBALS.gated.color,GAIA_GLOBALS.gated.alpha),$(".layer-gate-cover").css("position","relative").prepend('<div class="gate-cover" style="display:none;position:absolute;z-index:30000;top:0;left:0;width:100%;height:100%;background-color:'+t+';"></div>').on("layerGate:unlock",function(e){$(this).find(".gate-cover").fadeOut("slow")}),$(".layer-gate-hide").hide().on("layerGate:unlock",function(e){$(this).slideDown("slow")}),$(".layer-tab-hide").hide(),$(".layer-tab-cover").css("position","relative").prepend('<div class="tab-cover" style="position:absolute;z-index:999;top:0;left:0;width:100%;height:100%;"></div>').on("layerGate:unlock",function(e){$(this).find(".tab-cover").fadeOut("slow")}))):$(".layer-hide-logged-in").hide(),$(".btn-popup-open").click(function(){$(".layer-popup").trigger("popup:clickOpenPopup",$(this))}),$(".post-tile__time .post-tile__time-bg").each(function(){jQuery.timeago&&($(this).hasClass("post-tile__time-old")?$(this).text(new Date(1e3*$(this).attr("datetime")).toLocaleDateString()):$(this).text(jQuery.timeago(1e3*$(this).attr("datetime")))).show()}),$('a[href*="#"]:not([href="#"])').click(function(e){e.preventDefault(),location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname&&(e=(e=$(this.hash)).length?e:$("[name="+this.hash.slice(1)+"]"),$.fn.smoothScroll(e,null,{duration:1}))}),$('a:not(.dropdown-menu-lang a, .selector__lang a, .nav-primary__item--mobile-no-link, [download], [data-clickblock="1"])').on("click",function(e){$(this).hasClass("jcarousel-control-prev")&&$(this).hasClass("jcarousel-control-next")&&$(this).parent().hasClass("jcarousel-pagination")||(e.preventDefault(),$.fn.linkCheck($(this)))}),$(window).resize(function(){this.resizeTO&&clearTimeout(this.resizeTO),this.resizeTO=setTimeout(function(){$(this).trigger("resize:resizeComplete")},250),$(".gate-keeper").is(":visible")&&$(".gate-keeper").trigger("layerGate:showGate")});var a=$.fn.getQueryString().tab;function n(e){e.hasClass("active-tab-nav")||(0<$(".active-tab-content").length?($(".gate-keeper").trigger("layerGate:hideGate"),$(".active-tab-content").animate({left:"5000px"},400,function(){$(this).hide().css("left",0),$(".layer-tab-cover, .layer-tab-hide, .layer-hidden").removeClass("active-tab-content").hide(),$(".tab-nav-item").removeClass("active-tab-nav"),$("#"+e.attr("data-tab-id")).css({left:"-5000px"}).show().addClass("active-tab-content").animate({left:"0px"},400,function(){$(".gate-keeper").trigger("layerGate:showGate")}),e.addClass("active-tab-nav"),$(window).width()<768&&$.fn.smoothScroll($(".tab-nav-item").first())})):($("#"+e.attr("data-tab-id")).addClass("active-tab-content").css({left:"-5000px"}).show().animate({left:"0px"},400,function(){$(".gate-keeper").trigger("layerGate:showGate")}),e.addClass("active-tab-nav"),$(".gate-keeper").trigger("layerGate:showGate"),$(window).width()<768&&$.fn.smoothScroll($(".tab-nav-item").first())));var t=e.attr("data-tab-id");!1!==t||(t="undefined"),$(document).trigger("tabEvent:tabOpen",t)}null!=a&&$(".tab-nav-item").each(function(e){var t=$(this);$(this).attr("data-tab-id")==a&&setTimeout(function(){n(t)},1e3)}),$(".tab-nav-item").click(function(){n($(this)),$("video").trigger("bcPlayer:stopAllPlayback")}),$("button.login__show-hide-password").on("click",function(e){e.preventDefault();let t=$(".login-password input");"password"==t.prop("type")?($(this).text($(this).data("hide-text")),t.prop("type","text")):($(this).text($(this).data("show-text")),t.prop("type","password"))}),$("button.login-btn").on("click",function(e){let t=$(".login-password input");t.prop("type","password")}),$(".login__register a").on("click",function(){dataLayer.push({event:"customEvent",eventCategory:"User Engagement",eventAction:"log in modal",eventLabel:"new to Gaia"})})});